(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[584],{2663:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>ej});var a=o(7876),r=o(4232),n=o(3930),i=o(964),c=o(1863),l=o(6520),s=o(5965),d=o(5348),p=o(9648),m=o(1428),u=o(6448),h=o(4527),g=o(7223),f=o(2809),v=o(9241),x=o(3323),y=o(7387),b=o(1257);let A=(0,b.A)((0,a.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");var C=o(8119),j=o(8037),I=o(6331),w=o(7947),k=o(3817),E=o(2443),S=o(985),P=o(4457),z=o(1849);function R(e){return(0,z.Ay)("MuiChip",e)}let N=(0,P.A)("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]);var _=o(4778);let O=e=>{let{classes:t,disabled:o,size:a,color:r,iconColor:n,onDelete:i,clickable:c,variant:l}=e,s={root:["root",l,o&&"disabled","size".concat((0,j.A)(a)),"color".concat((0,j.A)(r)),c&&"clickable",c&&"clickableColor".concat((0,j.A)(r)),i&&"deletable",i&&"deletableColor".concat((0,j.A)(r)),"".concat(l).concat((0,j.A)(r))],label:["label","label".concat((0,j.A)(a))],avatar:["avatar","avatar".concat((0,j.A)(a)),"avatarColor".concat((0,j.A)(r))],icon:["icon","icon".concat((0,j.A)(a)),"iconColor".concat((0,j.A)(n))],deleteIcon:["deleteIcon","deleteIcon".concat((0,j.A)(a)),"deleteIconColor".concat((0,j.A)(r)),"deleteIcon".concat((0,j.A)(l),"Color").concat((0,j.A)(r))]};return(0,x.A)(s,R,t)},M=(0,w.Ay)("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:o}=e,{color:a,iconColor:r,clickable:n,onDelete:i,size:c,variant:l}=o;return[{["& .".concat(N.avatar)]:t.avatar},{["& .".concat(N.avatar)]:t["avatar".concat((0,j.A)(c))]},{["& .".concat(N.avatar)]:t["avatarColor".concat((0,j.A)(a))]},{["& .".concat(N.icon)]:t.icon},{["& .".concat(N.icon)]:t["icon".concat((0,j.A)(c))]},{["& .".concat(N.icon)]:t["iconColor".concat((0,j.A)(r))]},{["& .".concat(N.deleteIcon)]:t.deleteIcon},{["& .".concat(N.deleteIcon)]:t["deleteIcon".concat((0,j.A)(c))]},{["& .".concat(N.deleteIcon)]:t["deleteIconColor".concat((0,j.A)(a))]},{["& .".concat(N.deleteIcon)]:t["deleteIcon".concat((0,j.A)(l),"Color").concat((0,j.A)(a))]},t.root,t["size".concat((0,j.A)(c))],t["color".concat((0,j.A)(a))],n&&t.clickable,n&&"default"!==a&&t["clickableColor".concat((0,j.A)(a),")")],i&&t.deletable,i&&"default"!==a&&t["deletableColor".concat((0,j.A)(a))],t[l],t["".concat(l).concat((0,j.A)(a))]]}})((0,k.A)(e=>{let{theme:t}=e,o="light"===t.palette.mode?t.palette.grey[700]:t.palette.grey[300];return{maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:16,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",["&.".concat(N.disabled)]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},["& .".concat(N.avatar)]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:o,fontSize:t.typography.pxToRem(12)},["& .".concat(N.avatarColorPrimary)]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},["& .".concat(N.avatarColorSecondary)]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},["& .".concat(N.avatarSmall)]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},["& .".concat(N.icon)]:{marginLeft:5,marginRight:-6},["& .".concat(N.deleteIcon)]:{WebkitTapHighlightColor:"transparent",color:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / 0.26)"):(0,y.X4)(t.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.vars?"rgba(".concat(t.vars.palette.text.primaryChannel," / 0.4)"):(0,y.X4)(t.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,["& .".concat(N.icon)]:{fontSize:18,marginLeft:4,marginRight:-4},["& .".concat(N.deleteIcon)]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(t.palette).filter((0,E.A)(["contrastText"])).map(e=>{let[o]=e;return{props:{color:o},style:{backgroundColor:(t.vars||t).palette[o].main,color:(t.vars||t).palette[o].contrastText,["& .".concat(N.deleteIcon)]:{color:t.vars?"rgba(".concat(t.vars.palette[o].contrastTextChannel," / 0.7)"):(0,y.X4)(t.palette[o].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[o].contrastText}}}}}),{props:e=>e.iconColor===e.color,style:{["& .".concat(N.icon)]:{color:t.vars?t.vars.palette.Chip.defaultIconColor:o}}},{props:e=>e.iconColor===e.color&&"default"!==e.color,style:{["& .".concat(N.icon)]:{color:"inherit"}}},{props:{onDelete:!0},style:{["&.".concat(N.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.selectedChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):(0,y.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}}},...Object.entries(t.palette).filter((0,E.A)(["dark"])).map(e=>{let[o]=e;return{props:{color:o,onDelete:!0},style:{["&.".concat(N.focusVisible)]:{background:(t.vars||t).palette[o].dark}}}}),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.selectedChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.hoverOpacity,"))"):(0,y.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)},["&.".concat(N.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.selectedChannel," / calc(").concat(t.vars.palette.action.selectedOpacity," + ").concat(t.vars.palette.action.focusOpacity,"))"):(0,y.X4)(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},"&:active":{boxShadow:(t.vars||t).shadows[1]}}},...Object.entries(t.palette).filter((0,E.A)(["dark"])).map(e=>{let[o]=e;return{props:{color:o,clickable:!0},style:{["&:hover, &.".concat(N.focusVisible)]:{backgroundColor:(t.vars||t).palette[o].dark}}}}),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:t.vars?"1px solid ".concat(t.vars.palette.Chip.defaultBorder):"1px solid ".concat("light"===t.palette.mode?t.palette.grey[400]:t.palette.grey[700]),["&.".concat(N.clickable,":hover")]:{backgroundColor:(t.vars||t).palette.action.hover},["&.".concat(N.focusVisible)]:{backgroundColor:(t.vars||t).palette.action.focus},["& .".concat(N.avatar)]:{marginLeft:4},["& .".concat(N.avatarSmall)]:{marginLeft:2},["& .".concat(N.icon)]:{marginLeft:4},["& .".concat(N.iconSmall)]:{marginLeft:2},["& .".concat(N.deleteIcon)]:{marginRight:5},["& .".concat(N.deleteIconSmall)]:{marginRight:3}}},...Object.entries(t.palette).filter((0,E.A)()).map(e=>{let[o]=e;return{props:{variant:"outlined",color:o},style:{color:(t.vars||t).palette[o].main,border:"1px solid ".concat(t.vars?"rgba(".concat(t.vars.palette[o].mainChannel," / 0.7)"):(0,y.X4)(t.palette[o].main,.7)),["&.".concat(N.clickable,":hover")]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[o].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,y.X4)(t.palette[o].main,t.palette.action.hoverOpacity)},["&.".concat(N.focusVisible)]:{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[o].mainChannel," / ").concat(t.vars.palette.action.focusOpacity,")"):(0,y.X4)(t.palette[o].main,t.palette.action.focusOpacity)},["& .".concat(N.deleteIcon)]:{color:t.vars?"rgba(".concat(t.vars.palette[o].mainChannel," / 0.7)"):(0,y.X4)(t.palette[o].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[o].main}}}}})]}})),T=(0,w.Ay)("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,t)=>{let{ownerState:o}=e,{size:a}=o;return[t.label,t["label".concat((0,j.A)(a))]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function L(e){return"Backspace"===e.key||"Delete"===e.key}let V=r.forwardRef(function(e,t){let o=(0,S.b)({props:e,name:"MuiChip"}),{avatar:n,className:i,clickable:c,color:l="default",component:s,deleteIcon:d,disabled:p=!1,icon:m,label:u,onClick:h,onDelete:g,onKeyDown:f,onKeyUp:x,size:y="medium",variant:b="filled",tabIndex:j,skipFocusWhenDisabled:w=!1,slots:k={},slotProps:E={},...P}=o,z=r.useRef(null),R=(0,C.A)(z,t),N=e=>{e.stopPropagation(),g&&g(e)},V=e=>{e.currentTarget===e.target&&L(e)&&e.preventDefault(),f&&f(e)},D=e=>{e.currentTarget===e.target&&g&&L(e)&&g(e),x&&x(e)},X=!1!==c&&!!h||c,F=X||g?I.A:s||"div",H={...o,component:F,disabled:p,size:y,color:l,iconColor:r.isValidElement(m)&&m.props.color||l,onDelete:!!g,clickable:X,variant:b},W=O(H),q=F===I.A?{component:s||"div",focusVisibleClassName:W.focusVisible,...g&&{disableRipple:!0}}:{},B=null;g&&(B=d&&r.isValidElement(d)?r.cloneElement(d,{className:(0,v.A)(d.props.className,W.deleteIcon),onClick:N}):(0,a.jsx)(A,{className:W.deleteIcon,onClick:N}));let U=null;n&&r.isValidElement(n)&&(U=r.cloneElement(n,{className:(0,v.A)(W.avatar,n.props.className)}));let $=null;m&&r.isValidElement(m)&&($=r.cloneElement(m,{className:(0,v.A)(W.icon,m.props.className)}));let J={slots:k,slotProps:E},[G,K]=(0,_.A)("root",{elementType:M,externalForwardedProps:{...J,...P},ownerState:H,shouldForwardComponentProp:!0,ref:R,className:(0,v.A)(W.root,i),additionalProps:{disabled:!!X&&!!p||void 0,tabIndex:w&&p?-1:j,...q},getSlotProps:e=>({...e,onClick:t=>{var o;null==(o=e.onClick)||o.call(e,t),h(t)},onKeyDown:t=>{var o;null==(o=e.onKeyDown)||o.call(e,t),V(t)},onKeyUp:t=>{var o;null==(o=e.onKeyUp)||o.call(e,t),D(t)}})}),[Y,Q]=(0,_.A)("label",{elementType:T,externalForwardedProps:J,ownerState:H,className:W.label});return(0,a.jsxs)(G,{as:F,...K,children:[U||$,(0,a.jsx)(Y,{...Q,children:u}),B]})});var D=o(2460),X=o(2039),F=o(9299),H=o(510),W=o(9281),q=o(1897),B=o(8067),U=o(2643),$=o(5657),J=o(7444),G=o(4293),K=o(2528),Y=o(2199),Q=o(7438),Z=o(3355),ee=o(5048),et=o(1200),eo=o(181),ea=o(3866),er=o(7990),en=o(9751);class ei extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,o=(0,er.s)(e)&&e.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=o-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function ec({children:e,isPresent:t,anchorX:o}){let n=(0,r.useId)(),i=(0,r.useRef)(null),c=(0,r.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=(0,r.useContext)(en.Q);return(0,r.useInsertionEffect)(()=>{let{width:e,height:a,top:r,left:s,right:d}=c.current;if(t||!i.current||!e||!a)return;let p="left"===o?`left: ${s}`:`right: ${d}`;i.current.dataset.motionPopId=n;let m=document.createElement("style");return l&&(m.nonce=l),document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${a}px !important;
            ${p}px !important;
            top: ${r}px !important;
          }
        `),()=>{document.head.contains(m)&&document.head.removeChild(m)}},[t]),(0,a.jsx)(ei,{isPresent:t,childRef:i,sizeRef:c,children:r.cloneElement(e,{ref:i})})}let el=({children:e,initial:t,isPresent:o,onExitComplete:n,custom:i,presenceAffectsLayout:c,mode:l,anchorX:s})=>{let d=(0,et.M)(es),p=(0,r.useId)(),m=!0,u=(0,r.useMemo)(()=>(m=!1,{id:p,initial:t,isPresent:o,custom:i,onExitComplete:e=>{for(let t of(d.set(e,!0),d.values()))if(!t)return;n&&n()},register:e=>(d.set(e,!1),()=>d.delete(e))}),[o,d,n]);return c&&m&&(u={...u}),(0,r.useMemo)(()=>{d.forEach((e,t)=>d.set(t,!1))},[o]),r.useEffect(()=>{o||d.size||!n||n()},[o]),"popLayout"===l&&(e=(0,a.jsx)(ec,{isPresent:o,anchorX:s,children:e})),(0,a.jsx)(ea.t.Provider,{value:u,children:e})};function es(){return new Map}var ed=o(3885);let ep=e=>e.key||"";function em(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let eu=({children:e,custom:t,initial:o=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:c="sync",propagate:l=!1,anchorX:s="left"})=>{let[d,p]=(0,ed.xQ)(l),m=(0,r.useMemo)(()=>em(e),[e]),u=l&&!d?[]:m.map(ep),h=(0,r.useRef)(!0),g=(0,r.useRef)(m),f=(0,et.M)(()=>new Map),[v,x]=(0,r.useState)(m),[y,b]=(0,r.useState)(m);(0,eo.E)(()=>{h.current=!1,g.current=m;for(let e=0;e<y.length;e++){let t=ep(y[e]);u.includes(t)?f.delete(t):!0!==f.get(t)&&f.set(t,!1)}},[y,u.length,u.join("-")]);let A=[];if(m!==v){let e=[...m];for(let t=0;t<y.length;t++){let o=y[t],a=ep(o);u.includes(a)||(e.splice(t,0,o),A.push(o))}return"wait"===c&&A.length&&(e=A),b(em(e)),x(m),null}let{forceRender:C}=(0,r.useContext)(ee.L);return(0,a.jsx)(a.Fragment,{children:y.map(e=>{let r=ep(e),v=(!l||!!d)&&(m===y||u.includes(r));return(0,a.jsx)(el,{isPresent:v,initial:(!h.current||!!o)&&void 0,custom:t,presenceAffectsLayout:i,mode:c,onExitComplete:v?void 0:()=>{if(!f.has(r))return;f.set(r,!0);let e=!0;f.forEach(t=>{t||(e=!1)}),e&&(C?.(),b(g.current),l&&p?.(),n&&n())},anchorX:s,children:e},r)})})},eh=(0,b.A)((0,a.jsx)("path",{d:"M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4"}),"Restaurant"),eg=(0,b.A)((0,a.jsx)("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3m-3 11H8v-5h8zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m-1-9H6v4h12z"}),"LocalPrintshop");var ef=o(7366),ev=o(5157),ex=o(2893);let ey=(0,b.A)((0,a.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications"),eb=(0,b.A)((0,a.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh");var eA=o(8110);o(6140),o(1123);let eC=(0,n.UU)("https://ajwmtfpsuxuunncovkqv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFqd210ZnBzdXh1dW5uY292a3F2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5MjQ1MTAsImV4cCI6MjA2NDUwMDUxMH0.KH4qq9dlEl9w7mbERPxrae58kdtXWcGdseOc_h6YMjY");function ej(){let[e,t]=(0,r.useState)([]),[o,n]=(0,r.useState)(!0),[v,x]=(0,r.useState)(null),[y,b]=(0,r.useState)(!1),[A,C]=(0,r.useState)({open:!1,message:"",severity:"success"}),[j,I]=(0,r.useState)(!1),w=(0,r.useRef)(null),k=(0,i.A)();(0,c.A)(k.breakpoints.down("md"));let E=async()=>{n(!0);try{console.log("Iniciando busca de pedidos...");let{data:o,error:a}=await eC.from("orders").select("*").in("status",["pending","preparing"]).order("created_at",{ascending:!1});if(console.log("Pedidos pendentes/em preparo:",{ordersData:o,ordersError:a}),a){console.error("Erro ao buscar pedidos:",a),C({open:!0,message:"Erro ao buscar pedidos: ".concat(a.message),severity:"error"}),n(!1);return}if(!o||0===o.length){console.log("Nenhum pedido pendente encontrado"),t([]),n(!1);return}console.log("Encontrados ".concat(o.length," pedidos pendentes/em preparo"));let r=e.length,i=[],c=o.map(e=>e.id),{data:l,error:s}=await eC.from("order_items").select("*").in("order_id",c);s&&(console.error("Erro ao buscar itens dos pedidos:",s),C({open:!0,message:"Erro ao buscar itens: ".concat(s.message),severity:"error"})),console.log("Todos os itens de pedidos:",l);let d=l?[...new Set(l.map(e=>e.menu_item_id).filter(Boolean))]:[],p=[];if(d.length>0){let{data:e,error:t}=await eC.from("menu_items").select("*").in("id",d);t?console.error("Erro ao buscar itens do menu:",t):e&&(p=e,console.log("Itens do menu encontrados:",p.length))}for(let e of o){let t=(l?l.filter(t=>t.order_id===e.id):[]).map(e=>{let t=p.find(t=>t.id===e.menu_item_id);return{id:e.id,name:(null==t?void 0:t.name)||"Item #".concat(e.menu_item_id),quantity:e.quantity,notes:e.notes}});i.push({id:e.id,table_id:e.table_id,status:e.status,created_at:e.created_at,total:"number"==typeof e.total?e.total:parseFloat(e.total)||0,items:t})}if(t(i),i.length>r){console.log("Novos pedidos detectados! Anterior: ".concat(r,", Atual: ").concat(i.length)),I(!0);try{let e=new Audio("/notification.mp3").play();void 0!==e&&e.then(()=>console.log("Notifica\xe7\xe3o sonora reproduzida com sucesso")).catch(e=>{console.error("Erro ao tocar notifica\xe7\xe3o:",e),C({open:!0,message:"Novo pedido recebido! Clique para ativar som.",severity:"info"})})}catch(e){console.error("Exce\xe7\xe3o ao tocar som de notifica\xe7\xe3o:",e)}}}catch(e){console.error("Erro ao buscar pedidos:",e),C({open:!0,message:"Erro inesperado: ".concat(e),severity:"error"})}finally{n(!1)}},S=async()=>{if(!("Notification"in window))return void console.log("Este navegador n\xe3o suporta notifica\xe7\xf5es desktop");if("granted"===Notification.permission)console.log("Permiss\xe3o para notifica\xe7\xf5es j\xe1 concedida");else if("denied"!==Notification.permission)try{let e=await Notification.requestPermission();console.log("Permiss\xe3o para notifica\xe7\xf5es: ".concat(e))}catch(e){console.error("Erro ao solicitar permiss\xe3o para notifica\xe7\xf5es:",e)}};(0,r.useEffect)(()=>{new Audio("/notification.mp3").load(),S()},[]),(0,r.useEffect)(()=>{E();let e=setInterval(E,2e4),t=eC.channel("orders-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"orders"},e=>{if(console.log("Novo pedido detectado:",e),I(!0),E(),"Notification"in window&&"granted"===Notification.permission)try{new Notification("Novo Pedido!",{body:"Um novo pedido foi recebido na cozinha.",icon:"/favicon.ico"})}catch(e){console.error("Erro ao mostrar notifica\xe7\xe3o desktop:",e)}try{new Audio("/notification.mp3").play().catch(e=>console.error("Erro ao tocar som de notifica\xe7\xe3o:",e))}catch(e){console.error("Exce\xe7\xe3o ao tocar som:",e)}}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"orders"},e=>{console.log("Pedido atualizado:",e),E()}).subscribe(),o=eC.channel("order-items-changes").on("postgres_changes",{event:"*",schema:"public",table:"order_items"},e=>{console.log("Mudan\xe7a detectada em order_items:",e),E()}).subscribe();return()=>{clearInterval(e),eC.removeChannel(t),eC.removeChannel(o)}},[]);let P=async(e,t)=>{try{let o="completed"===t?"ready":t;console.log("Atualizando pedido ".concat(e," para status ").concat(o,"...")),n(!0);let{data:a,error:r}=await eC.from("orders").select("id").eq("id",e).single();if(r||!a){console.error("Erro ao verificar pedido:",r),C({open:!0,message:"Pedido n\xe3o encontrado",severity:"error"}),n(!1);return}let{error:i}=await eC.from("orders").update({status:o}).eq("id",e);i?(console.error("Erro ao atualizar pedido:",i),C({open:!0,message:"Erro ao atualizar pedido: ".concat(i.message),severity:"error"})):(console.log("Pedido ".concat(e," atualizado com sucesso para ").concat(o)),C({open:!0,message:"preparing"===o?"Pedido em preparo!":"Pedido pronto para servir!",severity:"success"}),E())}catch(e){console.error("Exce\xe7\xe3o ao atualizar pedido:",e),C({open:!0,message:"Erro inesperado: ".concat(e),severity:"error"})}finally{n(!1)}},z=(0,eA.useReactToPrint)({documentTitle:"Comanda",contentRef:w,onAfterPrint:()=>{console.log("Impress\xe3o conclu\xedda com sucesso"),b(!1),C({open:!0,message:"Comanda impressa com sucesso!",severity:"success"})},onPrintError:(e,t)=>{console.error("Erro ao imprimir (".concat(e,"):"),t),C({open:!0,message:"Erro ao imprimir: ".concat(t.message),severity:"error"})},pageStyle:"\n      @media print {\n        @page { size: 80mm auto; margin: 0mm; }\n        body { margin: 10mm 5mm; }\n      }\n    "}),R=e=>{if(console.log("Abrindo di\xe1logo de impress\xe3o para pedido:",e),!e.items||0===e.items.length)return void C({open:!0,message:"Pedido sem itens para imprimir",severity:"error"});x(e),b(!0),setTimeout(()=>{console.log("Componente de impress\xe3o pronto:",w.current)},300)},N=e=>{let t=new Date(e);return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)},_=e=>{let t=new Date(e).getTime(),o=Math.floor((new Date().getTime()-t)/6e4);return o<1?"Agora":1===o?"1 minuto":"".concat(o," minutos")};return o&&0===e.length?(0,a.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,a.jsx)(s.A,{size:60})}):(0,a.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh",background:k.palette.grey[50],fontFamily:"Inter, Roboto Flex, sans-serif"},children:[(0,a.jsx)(d.A,{position:"static",color:"primary",sx:{mb:2},children:(0,a.jsxs)(p.A,{children:[(0,a.jsx)(eh,{sx:{mr:2}}),(0,a.jsx)(m.A,{variant:"h6",sx:{flexGrow:1},children:"Cozinha"}),(0,a.jsx)(u.A,{title:"Atualizar pedidos",children:(0,a.jsx)(h.A,{color:"inherit",onClick:()=>{console.log("Atualizando pedidos manualmente..."),C({open:!0,message:"Atualizando pedidos...",severity:"info"}),E()},children:(0,a.jsx)(eb,{})})}),(0,a.jsx)(u.A,{title:j?"Novos pedidos!":"Nenhum novo pedido",children:(0,a.jsx)(g.A,{badgeContent:j?"!":0,color:"error",onClick:()=>{console.log("Limpando notifica\xe7\xe3o de novo pedido"),I(!1);try{new Audio("/notification.mp3").play().then(()=>console.log("Notifica\xe7\xe3o sonora reproduzida ap\xf3s intera\xe7\xe3o")).catch(e=>console.error("Ainda n\xe3o foi poss\xedvel reproduzir o som:",e))}catch(e){console.error("Exce\xe7\xe3o ao tocar som ap\xf3s intera\xe7\xe3o:",e)}},sx:{cursor:"pointer",animation:j?"pulse 1.5s infinite":"none","@keyframes pulse":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(1.2)"},"100%":{transform:"scale(1)"}}},children:(0,a.jsx)(ey,{color:j?"error":"inherit"})})})]})}),(0,a.jsx)(l.A,{component:"main",sx:{flexGrow:1,p:{xs:2,md:3},mt:8},children:(0,a.jsx)(f.A,{container:!0,spacing:3,justifyContent:"center",children:(0,a.jsxs)(l.A,{sx:{width:"100%",maxWidth:{md:"83.333%",lg:"75%"},mx:"auto"},children:[(0,a.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,a.jsx)(m.A,{variant:"h5",sx:{fontWeight:600,display:"flex",alignItems:"center",gap:1},children:"Pedidos Pendentes"}),(0,a.jsx)(V,{label:"".concat(e.length," ").concat(1===e.length?"pedido":"pedidos"),color:"primary",variant:"outlined"})]}),0===e.length&&!o&&(0,a.jsx)(Z.P.div,{initial:{opacity:0},animate:{opacity:1},children:(0,a.jsx)(D.A,{sx:{p:4,borderRadius:4,textAlign:"center",boxShadow:2},children:(0,a.jsxs)(X.A,{children:[(0,a.jsx)(m.A,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Nenhum pedido pendente no momento"}),(0,a.jsx)(m.A,{variant:"body2",color:"text.secondary",children:"Os novos pedidos aparecer\xe3o aqui automaticamente"})]})})}),(0,a.jsx)(eu,{children:e.map(e=>(0,a.jsx)(Z.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},transition:{duration:.3},children:(0,a.jsxs)(D.A,{sx:{mb:3,borderRadius:3,overflow:"visible",boxShadow:2,border:"pending"===e.status?"1px solid ".concat(k.palette.warning.main):"preparing"===e.status?"1px solid ".concat(k.palette.info.main):"none"},children:[(0,a.jsxs)(X.A,{children:[(0,a.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,a.jsxs)(m.A,{variant:"h6",sx:{fontWeight:700,color:"primary.main"},children:["Mesa ",e.table_id," - Pedido #",e.id]}),(0,a.jsx)(V,{icon:"pending"===e.status?(0,a.jsx)(ev.A,{}):(0,a.jsx)(ef.A,{}),label:"pending"===e.status?"Pendente":"Em preparo",color:"pending"===e.status?"warning":"info",size:"small"})]}),(0,a.jsxs)(m.A,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:2},children:["Recebido: ",N(e.created_at)," (",_(e.created_at)," atr\xe1s)"]}),(0,a.jsx)(F.A,{sx:{mb:2}}),(0,a.jsx)(H.A,{dense:!0,disablePadding:!0,children:e.items.map((e,t)=>(0,a.jsx)(W.Ay,{disableGutters:!0,sx:{py:1},children:(0,a.jsx)(q.A,{primary:(0,a.jsx)(l.A,{sx:{display:"flex",alignItems:"center"},children:(0,a.jsxs)(m.A,{variant:"body1",sx:{fontWeight:600},children:[e.quantity,"x ",e.name]})}),secondary:e.notes&&(0,a.jsxs)(m.A,{variant:"body2",sx:{fontStyle:"italic",mt:.5},children:["Obs: ",e.notes]})})},t))})]}),(0,a.jsxs)(B.A,{sx:{justifyContent:"flex-end",p:2,pt:0},children:[(0,a.jsx)(U.A,{startIcon:(0,a.jsx)(eg,{}),onClick:()=>R(e),variant:"outlined",size:"small",children:"Imprimir"}),"pending"===e.status&&(0,a.jsx)(U.A,{startIcon:(0,a.jsx)(ef.A,{}),onClick:()=>P(e.id,"preparing"),variant:"contained",color:"primary",size:"small",children:"Iniciar Preparo"}),"preparing"===e.status&&(0,a.jsx)(U.A,{startIcon:(0,a.jsx)(ex.A,{}),onClick:()=>P(e.id,"completed"),variant:"contained",color:"success",size:"small",children:"Concluir"})]})]})},e.id))})]})})}),(0,a.jsxs)($.A,{open:y,onClose:()=>b(!1),maxWidth:"sm",fullWidth:!0,children:[(0,a.jsx)(J.A,{children:"Imprimir Comanda"}),(0,a.jsx)(G.A,{children:v&&(0,a.jsxs)(l.A,{ref:w,sx:{p:2},children:[(0,a.jsxs)(m.A,{variant:"h6",align:"center",gutterBottom:!0,children:["COMANDA - MESA ",v.table_id]}),(0,a.jsxs)(m.A,{variant:"body2",align:"center",gutterBottom:!0,children:["Pedido #",v.id," - ",N(v.created_at)]}),(0,a.jsx)(F.A,{sx:{my:2}}),(0,a.jsx)(m.A,{variant:"subtitle2",gutterBottom:!0,children:"ITENS:"}),(0,a.jsx)(l.A,{sx:{mb:2},children:v.items.map((e,t)=>(0,a.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,a.jsxs)(m.A,{variant:"body2",children:[e.quantity,"x ",e.name]}),e.notes&&(0,a.jsx)(m.A,{variant:"body2",sx:{fontStyle:"italic",fontSize:"0.8rem"},children:e.notes})]},t))}),(0,a.jsx)(F.A,{sx:{my:2}}),(0,a.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)(m.A,{variant:"subtitle2",children:"TOTAL:"}),(0,a.jsxs)(m.A,{variant:"subtitle2",children:["R$ ","number"==typeof v.total?v.total.toFixed(2):"0.00"]})]}),(0,a.jsx)(m.A,{variant:"caption",align:"center",sx:{display:"block",mt:4},children:"Obrigado pela prefer\xeancia!"})]})}),(0,a.jsxs)(K.A,{children:[(0,a.jsx)(U.A,{onClick:()=>b(!1),children:"Cancelar"}),(0,a.jsx)(U.A,{onClick:()=>{console.log("Bot\xe3o de impress\xe3o clicado"),w.current?(console.log("Refer\xeancia do componente encontrada, iniciando impress\xe3o"),z()):(console.error("Refer\xeancia do componente n\xe3o encontrada"),C({open:!0,message:"Erro ao preparar impress\xe3o",severity:"error"}))},variant:"contained",color:"primary",startIcon:(0,a.jsx)(eg,{}),disabled:!v,children:"Imprimir"})]})]}),(0,a.jsx)(Y.A,{open:A.open,autoHideDuration:3e3,onClose:()=>C(e=>({...e,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,a.jsx)(Q.A,{severity:A.severity,variant:"filled",children:A.message})})]})}},5228:(e,t,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/kitchen",function(){return o(2663)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[942,921,714,636,593,792],()=>t(5228)),_N_E=e.O()}]);