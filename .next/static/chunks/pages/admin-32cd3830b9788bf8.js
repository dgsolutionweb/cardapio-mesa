(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[309],{4768:(e,i,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return s(5067)}])},5067:(e,i,s)=>{"use strict";s.r(i),s.d(i,{default:()=>et});var r=s(7876),n=s(4232),t=s(3930),a=s(964),o=s(1863),l=s(6520),d=s(2594),c=s(1428),x=s(9299),m=s(510),h=s(9281),u=s(4024),p=s(6587),j=s(1897),b=s(5348),A=s(9648),g=s(4527),y=s(1985),f=s(2809),v=s(2460),w=s(2039),C=s(5965),_=s(5505),S=s(2643),I=s(8067),R=s(5657),P=s(7444),k=s(4293),z=s(2528),W=s(1054),E=s(2199),M=s(7438),D=s(8921),q=s(9243),F=s(9770),N=s(2781),T=s(5878),O=s(2989),H=s(7012),L=s(1185),G=s(6686),$=s(3943),J=s(7366),B=s(7851),Q=s(9191),X=s(664),U=s(5157),V=s(2893),Y=s(2736),Z=s(3489),K=s(8847),ee=s.n(K),ei=s(3355),es=s(8110);s(6140),s(1123);let er=ee()(()=>s.e(950).then(s.bind(s,1950)).then(e=>e.QRCodeSVG),{loadableGenerated:{webpack:()=>[null]},ssr:!1}),en=(0,t.UU)("https://ajwmtfpsuxuunncovkqv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFqd210ZnBzdXh1dW5uY292a3F2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5MjQ1MTAsImV4cCI6MjA2NDUwMDUxMH0.KH4qq9dlEl9w7mbERPxrae58kdtXWcGdseOc_h6YMjY");function et(){var e,i,s;let[t,K]=(0,n.useState)([]),[ee,et]=(0,n.useState)(""),[ea,eo]=(0,n.useState)([]),[el,ed]=(0,n.useState)(!1),[ec,ex]=(0,n.useState)(null),[em,eh]=(0,n.useState)({name:"",description:"",price:"",image_url:""}),[eu,ep]=(0,n.useState)(!1),[ej,eb]=(0,n.useState)(null),[eA,eg]=(0,n.useState)([]),[ey,ef]=(0,n.useState)([]),[ev,ew]=(0,n.useState)(null),[eC,e_]=(0,n.useState)(!1),[eS,eI]=(0,n.useState)(null),[eR,eP]=(0,n.useState)(""),[ek,ez]=(0,n.useState)(!1),[eW,eE]=(0,n.useState)({open:!1,message:"",severity:"success"}),[eM,eD]=(0,n.useState)(!1),[eq,eF]=(0,n.useState)(!1),[eN,eT]=(0,n.useState)(!1),eO=(0,a.A)(),eH=(0,o.A)(eO.breakpoints.down("md")),eL=(0,n.useRef)(null);async function eG(){eD(!0);let{data:e}=await en.from("tables").select("*").order("number");e&&K(e),eD(!1)}async function e$(){eF(!0);try{let{data:e,error:i}=await en.from("orders").select("*").order("created_at",{ascending:!1});if(i){console.error("Erro ao buscar pedidos:",i),eE({open:!0,message:"Erro ao buscar pedidos: ".concat(i.message),severity:"error"});return}let{data:s,error:r}=await en.from("order_items").select("*, menu_items(*)");if(r){console.error("Erro ao buscar itens de pedidos:",r),eE({open:!0,message:"Erro ao buscar itens de pedidos: ".concat(r.message),severity:"error"});return}let n=(null==e?void 0:e.filter(e=>"completed"!==e.status))||[];console.log("Total de pedidos: ".concat((null==e?void 0:e.length)||0,", Pedidos ativos: ").concat(n.length)),0===n.length?console.log("Nenhum pedido ativo encontrado"):console.log("Pedidos ativos:",n),eg(e||[]),ef(s||[])}catch(e){console.error("Erro ao buscar pedidos:",e),eE({open:!0,message:"Erro inesperado: ".concat(e),severity:"error"})}finally{eF(!1)}}async function eJ(){eD(!0);let{data:e}=await en.from("menu_items").select("*").order("id");e&&eo(e),eD(!1)}async function eB(){ee&&(await en.from("tables").insert({number:Number(ee),status:"available"}),et(""),eG(),eE({open:!0,message:"Mesa adicionada!",severity:"success"}))}async function eQ(e){await en.from("tables").delete().eq("id",e),eG(),eE({open:!0,message:"Mesa removida!",severity:"info"})}function eX(){eb(null)}function eU(){e_(!1),eI(null)}async function eV(e){if(eS)try{let{error:i}=await en.from("tables").update({status:e}).eq("id",eS.id);if(i){console.error("Erro ao atualizar status da mesa:",i),eE({open:!0,message:"Erro ao atualizar mesa: ".concat(i.message),severity:"error"});return}eE({open:!0,message:"Mesa ".concat(eS.number," ").concat("available"===e?"dispon\xedvel":"occupied"===e?"marcada como ocupada":"reservada","!"),severity:"success"}),eU(),eG()}catch(e){console.error("Erro ao atualizar status da mesa:",e),eE({open:!0,message:"Erro inesperado: ".concat(e),severity:"error"})}}function eY(){ew(null)}function eZ(e,i){if(i)ew({...e,allTableOrders:i});else{let i=eA.filter(i=>i.table_id===e.table_id&&"completed"!==i.status);ew({...e,allTableOrders:i})}ez(!0)}function eK(){ez(!1)}(0,n.useEffect)(()=>{eG(),eJ(),e$()},[]);let e0=(0,es.useReactToPrint)({documentTitle:"Comanda",contentRef:eL,onAfterPrint:()=>{console.log("Impress\xe3o conclu\xedda com sucesso"),eT(!1),e1(),eE({open:!0,message:"Comanda impressa com sucesso!",severity:"success"})},onPrintError:(e,i)=>{console.error("Erro ao imprimir (".concat(e,"):"),i),eT(!1),eE({open:!0,message:"Erro ao imprimir: ".concat(i.message),severity:"error"})},pageStyle:"\n      @media print {\n        @page { size: 80mm auto; margin: 0mm; }\n        body { margin: 10mm 5mm; }\n      }\n    "});async function e2(){e0()}async function e1(){if(ev)try{let e=ev.allTableOrders||[ev];for(let i of(console.log("Finalizando ".concat(e.length," pedido(s) da mesa ").concat(ev.table_id)),e)){let{error:e}=await en.from("orders").update({status:"completed"}).eq("id",i.id);if(e){console.error("Erro ao completar pedido ".concat(i.id,":"),e),eE({open:!0,message:"Erro ao completar pedido: ".concat(e.message),severity:"error"});return}}let{data:i,error:s}=await en.from("orders").select("id").eq("table_id",ev.table_id).neq("status","completed");if(!i||0===i.length){let{error:e}=await en.from("tables").update({status:"available"}).eq("id",ev.table_id);e&&console.error("Erro ao atualizar status da mesa:",e)}eE({open:!0,message:"Conta fechada com sucesso!",severity:"success"}),eK(),eY(),e$(),eG()}catch(e){console.error("Erro ao finalizar pedidos:",e),eE({open:!0,message:"Erro inesperado: ".concat(e),severity:"error"})}}async function e5(){try{if(eD(!0),0===t.length)return void eE({open:!0,message:"Nenhuma mesa dispon\xedvel para criar pedido teste",severity:"error"});let e=t.find(e=>"available"===e.status)||t[0],{data:i,error:s}=await en.from("orders").insert({table_id:e.id,status:"pending",total:50,created_at:new Date().toISOString()}).select().single();if(s){console.error("Erro ao criar pedido de teste:",s),eE({open:!0,message:"Erro ao criar pedido de teste: ".concat(s.message),severity:"error"});return}if(!i)return void eE({open:!0,message:"Erro ao criar pedido: sem dados retornados",severity:"error"});let{error:r}=await en.from("order_items").insert({order_id:i.id,menu_item_id:1,quantity:2});r&&console.error("Erro ao adicionar item ao pedido de teste:",r);let{error:n}=await en.from("tables").update({status:"occupied"}).eq("id",e.id);n&&console.error("Erro ao atualizar status da mesa:",n),eE({open:!0,message:"Pedido de teste #".concat(i.id," criado com sucesso!"),severity:"success"}),e$(),eG()}catch(e){console.error("Erro ao criar pedido de teste:",e),eE({open:!0,message:"Erro inesperado: ".concat(e),severity:"error"})}finally{eD(!1)}}function e3(e){ex(e||null),eh(e?{...e,price:String(e.price)}:{name:"",description:"",price:"",image_url:""}),ed(!0)}function e6(){ed(!1),ex(null)}async function e4(){ec?(await en.from("menu_items").update({...em,price:Number(em.price)}).eq("id",ec.id),eE({open:!0,message:"Item atualizado!",severity:"success"})):(await en.from("menu_items").insert({...em,price:Number(em.price)}),eE({open:!0,message:"Item adicionado!",severity:"success"})),e6(),eJ()}async function e9(e){await en.from("menu_items").delete().eq("id",e),eJ(),eE({open:!0,message:"Item removido!",severity:"info"})}let[e7,e8]=(0,n.useState)("tables"),ie=(0,r.jsxs)(l.A,{sx:{width:260,pt:2,fontFamily:"Inter, Roboto Flex, sans-serif"},children:[(0,r.jsx)(ei.P.div,{initial:{scale:.7,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:180,damping:14},children:(0,r.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mb:1},children:[(0,r.jsx)(d.A,{sx:{bgcolor:"primary.main",width:64,height:64,mb:1,boxShadow:3},children:(0,r.jsx)(L.A,{sx:{fontSize:38}})}),(0,r.jsx)(c.A,{variant:"h5",sx:{fontWeight:800,color:"primary.main",letterSpacing:1},children:"Painel Admin"})]})}),(0,r.jsx)(x.A,{}),(0,r.jsxs)(m.A,{children:[(0,r.jsx)(h.Ay,{disablePadding:!0,children:(0,r.jsxs)(u.A,{selected:"tables"===e7,onClick:()=>e8("tables"),sx:{borderRadius:2,mb:1,"&.Mui-selected":{bgcolor:"primary.main",color:"white","& .MuiListItemIcon-root":{color:"white"}}},children:[(0,r.jsx)(p.A,{children:(0,r.jsx)(q.A,{})}),(0,r.jsx)(j.A,{primary:"Mesas"})]})}),(0,r.jsx)(h.Ay,{disablePadding:!0,children:(0,r.jsxs)(u.A,{selected:"menu"===e7,onClick:()=>e8("menu"),sx:{borderRadius:2,mb:1,"&.Mui-selected":{bgcolor:"primary.main",color:"white","& .MuiListItemIcon-root":{color:"white"}}},children:[(0,r.jsx)(p.A,{children:(0,r.jsx)(F.A,{})}),(0,r.jsx)(j.A,{primary:"Card\xe1pio"})]})}),(0,r.jsx)(h.Ay,{disablePadding:!0,children:(0,r.jsxs)(u.A,{selected:"orders"===e7,onClick:()=>e8("orders"),sx:{borderRadius:2,mb:1,"&.Mui-selected":{bgcolor:"primary.main",color:"white","& .MuiListItemIcon-root":{color:"white"}}},children:[(0,r.jsx)(p.A,{children:(0,r.jsx)(G.A,{})}),(0,r.jsx)(j.A,{primary:"Pedidos"})]})}),(0,r.jsx)(h.Ay,{disablePadding:!0,children:(0,r.jsxs)(u.A,{selected:"settings"===e7,onClick:()=>e8("settings"),sx:{borderRadius:2,"&.Mui-selected":{bgcolor:"primary.main",color:"white","& .MuiListItemIcon-root":{color:"white"}}},children:[(0,r.jsx)(p.A,{children:(0,r.jsx)($.A,{})}),(0,r.jsx)(j.A,{primary:"Configura\xe7\xf5es"})]})})]}),(0,r.jsx)(x.A,{sx:{my:2}}),(0,r.jsx)(l.A,{sx:{textAlign:"center",color:"text.secondary",fontSize:13,mt:2},children:(0,r.jsxs)(ei.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:[new Date().getFullYear()," Card\xe1pio Digital"]})})]});return(0,r.jsxs)(l.A,{sx:{display:"flex",minHeight:"100vh",background:eO.palette.grey[50]},children:[(0,r.jsx)(b.A,{position:"fixed",sx:{zIndex:eO.zIndex.drawer+1,background:"linear-gradient(90deg, #1976d2 60%, #2196f3 100%)"},children:(0,r.jsxs)(A.A,{children:[eH&&(0,r.jsx)(g.A,{color:"inherit",edge:"start",onClick:()=>ep(!0),sx:{mr:2},children:(0,r.jsx)(D.A,{})}),(0,r.jsx)(c.A,{variant:"h6",noWrap:!0,component:"div",sx:{fontWeight:700},children:"Card\xe1pio Digital - Administra\xe7\xe3o"})]})}),(0,r.jsx)(y.Ay,{variant:eH?"temporary":"permanent",open:eu,onClose:()=>ep(!1),sx:{width:260,flexShrink:0,"& .MuiDrawer-paper":{width:260,boxSizing:"border-box",background:"#fff"}},children:ie}),(0,r.jsxs)(l.A,{component:"main",sx:{flexGrow:1,p:{xs:2,md:4},mt:8,fontFamily:"Inter, Roboto Flex, sans-serif"},children:["tables"===e7&&(0,r.jsx)(f.A,{container:!0,spacing:4,justifyContent:"center",children:(0,r.jsx)(f.A,{size:{xs:12,md:7,lg:5},children:(0,r.jsx)(ei.P.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:(0,r.jsx)(v.A,{sx:{p:2,minHeight:320,display:"flex",flexDirection:"column",boxShadow:3,borderRadius:4,background:"rgba(255,255,255,0.97)",transition:"box-shadow 0.2s","&:hover":{boxShadow:7}},children:(0,r.jsxs)(w.A,{sx:{flexGrow:1},children:[(0,r.jsx)(c.A,{variant:"h6",sx:{mb:2,fontWeight:700,color:"primary.main",letterSpacing:.5},children:"Mesas"}),eM?(0,r.jsx)(l.A,{sx:{textAlign:"center",mt:4},children:(0,r.jsx)(C.A,{})}):(0,r.jsx)(m.A,{dense:!0,children:t.map(e=>(0,r.jsx)(ei.P.div,{whileHover:{scale:1.03},children:(0,r.jsx)(h.Ay,{secondaryAction:(0,r.jsxs)(l.A,{children:[(0,r.jsx)(g.A,{onClick:()=>{eb(e.number)},title:"Ver QR Code",color:"primary",sx:{mx:.5},children:(0,r.jsx)(H.A,{})}),(0,r.jsx)(g.A,{onClick:()=>eQ(e.id),title:"Remover",color:"error",sx:{mx:.5},children:(0,r.jsx)(N.A,{})})]}),sx:{borderRadius:2,mb:.5,transition:"background 0.2s","&:hover":{background:"rgba(33,150,243,0.04)"}},children:(0,r.jsx)(j.A,{primary:(0,r.jsxs)("b",{children:["Mesa ",e.number]})})})},e.id))}),(0,r.jsxs)(l.A,{sx:{display:"flex",gap:1,mt:2},children:[(0,r.jsx)(_.A,{label:"Nova mesa",size:"small",value:ee,onChange:e=>et(e.target.value),type:"number",sx:{flex:1}}),(0,r.jsx)(S.A,{onClick:eB,variant:"contained",startIcon:(0,r.jsx)(O.A,{}),color:"primary",sx:{fontWeight:700,borderRadius:3,boxShadow:1},children:"Adicionar"})]})]})})})})}),"menu"===e7&&(0,r.jsx)(f.A,{container:!0,spacing:3,children:(0,r.jsx)(f.A,{size:{xs:12},children:(0,r.jsx)(ei.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,r.jsx)(v.A,{sx:{p:3,borderRadius:4,boxShadow:2},children:(0,r.jsxs)(w.A,{children:[(0,r.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,r.jsxs)(c.A,{variant:"h5",sx:{fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)(F.A,{})," Card\xe1pio"]}),(0,r.jsx)(S.A,{variant:"contained",startIcon:(0,r.jsx)(O.A,{}),onClick:()=>e3(),sx:{borderRadius:2},children:"Novo Item"})]}),eM?(0,r.jsx)(l.A,{sx:{display:"flex",justifyContent:"center",py:4},children:(0,r.jsx)(C.A,{})}):(0,r.jsx)(f.A,{container:!0,spacing:2,children:ea.map(e=>(0,r.jsx)(f.A,{size:{xs:12,sm:6,md:6,lg:4},children:(0,r.jsx)(ei.P.div,{whileHover:{scale:1.03,boxShadow:"0 8px 32px 0 rgba(33,150,243,0.18)"},children:(0,r.jsxs)(v.A,{sx:{mb:2,boxShadow:1,borderRadius:3,height:"100%",display:"flex",flexDirection:"column",transition:"box-shadow 0.2s"},children:[e.image_url&&(0,r.jsx)(ei.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.15},children:(0,r.jsx)(l.A,{sx:{width:"100%",height:120,background:"url(".concat(e.image_url,") center/cover"),borderRadius:2}})}),(0,r.jsxs)(w.A,{sx:{flexGrow:1},children:[(0,r.jsx)(c.A,{variant:"subtitle1",sx:{fontWeight:700},children:e.name}),(0,r.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:1},children:e.description}),(0,r.jsxs)(c.A,{variant:"subtitle2",color:"primary",children:["R$ ",Number(e.price).toFixed(2)]})]}),(0,r.jsxs)(I.A,{sx:{justifyContent:"flex-end",pb:1},children:[(0,r.jsx)(g.A,{onClick:()=>e3(e),title:"Editar",color:"primary",children:(0,r.jsx)(T.A,{})}),(0,r.jsx)(g.A,{onClick:()=>e9(e.id),title:"Remover",color:"error",children:(0,r.jsx)(N.A,{})})]})]})})},e.id))})]})})})})}),"orders"===e7&&(0,r.jsxs)(f.A,{container:!0,spacing:3,children:[(0,r.jsx)(f.A,{size:{xs:12,md:6},children:(0,r.jsx)(ei.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,r.jsx)(v.A,{sx:{p:2,minHeight:320,display:"flex",flexDirection:"column",boxShadow:3,borderRadius:4,background:"rgba(255,255,255,0.97)"},children:(0,r.jsxs)(w.A,{sx:{flexGrow:1},children:[(0,r.jsx)(c.A,{variant:"h6",sx:{mb:2,fontWeight:700,color:"primary.main",letterSpacing:.5},children:"Status das Mesas"}),eM?(0,r.jsx)(l.A,{sx:{textAlign:"center",mt:4},children:(0,r.jsx)(C.A,{})}):(0,r.jsx)(f.A,{container:!0,spacing:2,children:t.map(e=>{let i="success.light",s="Dispon\xedvel",n=(0,r.jsx)(J.A,{});return"occupied"===e.status?(i="error.light",s="Ocupada",n=(0,r.jsx)(Q.A,{})):"reserved"===e.status&&(i="warning.light",s="Reservada",n=(0,r.jsx)(B.A,{})),(0,r.jsx)(f.A,{size:{xs:6,sm:4},children:(0,r.jsx)(ei.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,r.jsx)(v.A,{sx:{p:1.5,bgcolor:i,color:"white",cursor:"pointer",textAlign:"center",boxShadow:2,borderRadius:2,transition:"transform 0.2s"},onClick:()=>{eI(e),eP(""),e_(!0)},children:(0,r.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.jsxs)(c.A,{variant:"h5",sx:{fontWeight:"bold",mb:.5},children:["Mesa ",e.number]}),(0,r.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[n,(0,r.jsx)(c.A,{variant:"body2",children:s})]})]})})})},e.id)})})]})})})}),(0,r.jsx)(f.A,{size:{xs:12,md:6},children:(0,r.jsx)(ei.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:(0,r.jsx)(v.A,{sx:{p:2,minHeight:320,display:"flex",flexDirection:"column",boxShadow:3,borderRadius:4,background:"rgba(255,255,255,0.97)"},children:(0,r.jsxs)(w.A,{sx:{flexGrow:1},children:[(0,r.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,r.jsx)(c.A,{variant:"h6",sx:{fontWeight:700,color:"primary.main",letterSpacing:.5},children:"Pedidos Ativos"}),(0,r.jsx)(S.A,{size:"small",variant:"outlined",onClick:e5,disabled:eM,children:"Criar Pedido Teste"})]}),eq?(0,r.jsx)(l.A,{sx:{textAlign:"center",mt:4},children:(0,r.jsx)(C.A,{})}):(0,r.jsx)(m.A,{sx:{width:"100%"},children:0===eA.filter(e=>"completed"!==e.status).length?(0,r.jsx)(l.A,{sx:{textAlign:"center",py:2},children:(0,r.jsx)(c.A,{children:"Nenhum pedido ativo no momento"})}):Object.entries(eA.filter(e=>"completed"!==e.status).reduce((e,i)=>{let s=i.table_id;return e[s]||(e[s]=[]),e[s].push(i),e},{})).map(e=>{let[i,s]=e,n=t.find(e=>e.id===Number(i)),a=s.reduce((e,i)=>e+Number(i.total||0),0),o=s.some(e=>"ready"===e.status),d=s.some(e=>"preparing"===e.status),x=s.some(e=>"pending"===e.status),m="Pendente",u="warning.main",p=(0,r.jsx)(U.A,{fontSize:"small"});return!o||d||x?d&&(m="Em preparo",u="info.main",p=(0,r.jsx)(L.A,{fontSize:"small"})):(m="Pronto para servir",u="success.main",p=(0,r.jsx)(V.A,{fontSize:"small"})),(0,r.jsx)(h.Ay,{sx:{p:0,mb:2,display:"block"},children:(0,r.jsx)(ei.P.div,{whileHover:{scale:1.01},children:(0,r.jsx)(v.A,{sx:{borderRadius:2,boxShadow:1,bgcolor:"grey.50",overflow:"visible"},children:(0,r.jsxs)(w.A,{children:[(0,r.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,r.jsxs)(c.A,{variant:"subtitle1",sx:{fontWeight:"bold"},children:["Mesa ",(null==n?void 0:n.number)||i]}),(0,r.jsx)(l.A,{sx:{display:"flex",alignItems:"center"},children:(0,r.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",bgcolor:"".concat(u,"15"),color:u,px:1,py:.5,borderRadius:1,mr:1},children:[p,(0,r.jsx)(c.A,{variant:"caption",sx:{ml:.5,fontWeight:"medium"},children:m})]})})]}),(0,r.jsxs)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[s.length," ",1===s.length?"pedido":"pedidos"," • R$ ",a.toFixed(2)]}),(0,r.jsxs)(l.A,{sx:{mt:2},children:[(0,r.jsx)(S.A,{size:"small",variant:"outlined",onClick:()=>{ew(s[0])},sx:{mr:1},children:"Ver Detalhes"}),(0,r.jsx)(S.A,{size:"small",variant:"contained",color:"primary",onClick:()=>eZ(s[0],s),startIcon:(0,r.jsx)(X.A,{}),children:"Pagamento"})]})]})})})},i)})})]})})})}),(0,r.jsx)(f.A,{size:{xs:12},children:(0,r.jsx)(ei.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:(0,r.jsx)(v.A,{sx:{p:2,display:"flex",flexDirection:"column",boxShadow:3,borderRadius:4,background:"rgba(255,255,255,0.97)"},children:(0,r.jsxs)(w.A,{children:[(0,r.jsx)(c.A,{variant:"h6",sx:{mb:2,fontWeight:700,color:"primary.main",letterSpacing:.5},children:"Hist\xf3rico de Pedidos"}),eq?(0,r.jsx)(l.A,{sx:{textAlign:"center",mt:4},children:(0,r.jsx)(C.A,{})}):(0,r.jsxs)(m.A,{sx:{width:"100%"},children:[eA.filter(e=>"completed"===e.status).slice(0,5).map(e=>{let i=t.find(i=>i.id===e.table_id),s=ey.filter(i=>i.order_id===e.id),n=e.total||s.reduce((e,i)=>{var s;return e+i.quantity*((null==(s=i.menu_items)?void 0:s.price)||0)},0);return(0,r.jsx)(ei.P.div,{whileHover:{scale:1.01},children:(0,r.jsx)(v.A,{sx:{mb:2,borderRadius:2,boxShadow:1,bgcolor:"grey.50"},children:(0,r.jsxs)(w.A,{children:[(0,r.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,r.jsxs)(c.A,{variant:"subtitle1",sx:{fontWeight:"bold"},children:["Mesa ",(null==i?void 0:i.number)||e.table_id]}),(0,r.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,r.jsx)(V.A,{fontSize:"small",color:"success"}),(0,r.jsx)(c.A,{variant:"body2",color:"text.secondary",children:new Date(e.created_at).toLocaleDateString("pt-BR")})]})]}),(0,r.jsxs)(c.A,{variant:"body2",color:"text.secondary",children:[s.length," ",1===s.length?"item":"itens"," • R$ ",n.toFixed(2)]})]})})},e.id)}),0===eA.filter(e=>"completed"===e.status).length&&(0,r.jsxs)(l.A,{sx:{textAlign:"center",py:4,color:"text.secondary"},children:[(0,r.jsx)(G.A,{sx:{fontSize:40,opacity:.3,mb:1}}),(0,r.jsx)(c.A,{children:"Nenhum pedido finalizado"})]})]})]})})})})]}),"settings"===e7&&(0,r.jsx)(f.A,{container:!0,spacing:3,children:(0,r.jsx)(f.A,{size:{xs:12},children:(0,r.jsx)(ei.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,r.jsx)(v.A,{sx:{p:3,borderRadius:4,boxShadow:2},children:(0,r.jsxs)(w.A,{children:[(0,r.jsx)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:(0,r.jsxs)(c.A,{variant:"h5",sx:{fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,r.jsx)($.A,{})," Configura\xe7\xf5es"]})}),(0,r.jsx)(c.A,{variant:"body1",color:"text.secondary",align:"center",children:"Em breve voc\xea poder\xe1 personalizar todas as configura\xe7\xf5es do sistema aqui!"})]})})})})}),(0,r.jsxs)(R.A,{open:el,onClose:e6,maxWidth:"xs",fullWidth:!0,children:[(0,r.jsxs)(P.A,{children:[ec?"Editar":"Novo"," item do card\xe1pio"]}),(0,r.jsxs)(k.A,{children:[(0,r.jsx)(_.A,{label:"Nome",fullWidth:!0,margin:"dense",value:em.name,onChange:e=>eh(i=>({...i,name:e.target.value}))}),(0,r.jsx)(_.A,{label:"Descri\xe7\xe3o",fullWidth:!0,margin:"dense",value:em.description,onChange:e=>eh(i=>({...i,description:e.target.value}))}),(0,r.jsx)(_.A,{label:"Pre\xe7o",fullWidth:!0,margin:"dense",value:em.price,onChange:e=>eh(i=>({...i,price:e.target.value})),type:"number"}),(0,r.jsx)(_.A,{label:"URL da imagem",fullWidth:!0,margin:"dense",value:em.image_url,onChange:e=>eh(i=>({...i,image_url:e.target.value}))})]}),(0,r.jsxs)(z.A,{children:[(0,r.jsx)(S.A,{onClick:e6,children:"Cancelar"}),(0,r.jsx)(S.A,{onClick:e4,variant:"contained",children:"Salvar"})]})]}),(0,r.jsxs)(R.A,{open:null!==ej,onClose:eX,maxWidth:"xs",fullWidth:!0,children:[(0,r.jsxs)(P.A,{children:["QR Code - Mesa ",ej]}),(0,r.jsxs)(k.A,{sx:{textAlign:"center",py:3},children:[(0,r.jsx)(er,{value:"".concat(window.location.origin,"/menu?table=").concat(ej),size:200}),(0,r.jsxs)(c.A,{variant:"body2",sx:{mt:2},children:["Escaneie este QR code para acessar o card\xe1pio digital da Mesa ",ej]})]}),(0,r.jsx)(z.A,{children:(0,r.jsx)(S.A,{onClick:eX,children:"Fechar"})})]}),(0,r.jsxs)(R.A,{open:eC,onClose:eU,maxWidth:"xs",fullWidth:!0,children:[(0,r.jsxs)(P.A,{children:["Gerenciar Mesa ",null==eS?void 0:eS.number]}),(0,r.jsxs)(k.A,{children:[(0,r.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Selecione o status atual desta mesa:"}),(0,r.jsxs)(f.A,{container:!0,spacing:2,children:[(0,r.jsx)(f.A,{size:{xs:4},children:(0,r.jsx)(ei.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,r.jsx)(v.A,{sx:{p:1.5,bgcolor:"success.light",color:"white",cursor:"pointer",textAlign:"center",boxShadow:2,borderRadius:2},onClick:()=>eV("available"),children:(0,r.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.jsx)(J.A,{sx:{fontSize:36,mb:1}}),(0,r.jsx)(c.A,{variant:"body2",sx:{fontWeight:"bold"},children:"Dispon\xedvel"})]})})})}),(0,r.jsx)(f.A,{size:{xs:4},children:(0,r.jsx)(ei.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,r.jsx)(v.A,{sx:{p:1.5,bgcolor:"error.light",color:"white",cursor:"pointer",textAlign:"center",boxShadow:2,borderRadius:2},onClick:()=>eV("occupied"),children:(0,r.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.jsx)(Q.A,{sx:{fontSize:36,mb:1}}),(0,r.jsx)(c.A,{variant:"body2",sx:{fontWeight:"bold"},children:"Ocupada"})]})})})}),(0,r.jsx)(f.A,{size:{xs:4},children:(0,r.jsx)(ei.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,r.jsx)(v.A,{sx:{p:1.5,bgcolor:"warning.light",color:"white",cursor:"pointer",textAlign:"center",boxShadow:2,borderRadius:2},onClick:()=>eV("reserved"),children:(0,r.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.jsx)(B.A,{sx:{fontSize:36,mb:1}}),(0,r.jsx)(c.A,{variant:"body2",sx:{fontWeight:"bold"},children:"Reservada"})]})})})})]}),(null==eS?void 0:eS.status)==="reserved"&&(0,r.jsx)(_.A,{margin:"dense",label:"Nome da reserva",fullWidth:!0,variant:"outlined",value:eR,onChange:e=>eP(e.target.value),sx:{mt:3}})]}),(0,r.jsx)(z.A,{children:(0,r.jsx)(S.A,{onClick:eU,children:"Cancelar"})})]}),(0,r.jsx)(R.A,{open:null!==ev&&!ek,onClose:eY,maxWidth:"sm",fullWidth:!0,children:ev&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.A,{children:(0,r.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsx)(c.A,{variant:"h6",children:"Detalhes do Pedido"}),(0,r.jsx)(g.A,{onClick:eY,size:"small",children:(0,r.jsx)(Y.A,{})})]})}),(0,r.jsxs)(k.A,{children:[(0,r.jsxs)(l.A,{sx:{mb:3,p:2,bgcolor:"primary.light",color:"white",borderRadius:2},children:[(0,r.jsxs)(c.A,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:["Mesa ",(null==(e=t.find(e=>e.id===ev.table_id))?void 0:e.number)||ev.table_id]}),(0,r.jsxs)(c.A,{variant:"body2",children:["Pedido #",ev.id," • ",new Date(ev.created_at).toLocaleString("pt-BR")]})]}),(0,r.jsx)(c.A,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:"Itens do Pedido:"}),(0,r.jsx)(m.A,{children:ey.filter(e=>e.order_id===ev.id).map(e=>{var i,s;return(0,r.jsxs)(h.Ay,{sx:{py:1,px:0,borderBottom:"1px solid #eee"},children:[(0,r.jsx)(j.A,{primary:(null==(i=e.menu_items)?void 0:i.name)||"Item #".concat(e.menu_item_id),secondary:e.notes||""}),(0,r.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,r.jsxs)(c.A,{variant:"body2",color:"text.secondary",children:[e.quantity,"x"]}),(0,r.jsxs)(c.A,{variant:"body2",sx:{fontWeight:"bold"},children:["R$ ",(((null==(s=e.menu_items)?void 0:s.price)||0)*e.quantity).toFixed(2)]})]})]},e.id)})}),(0,r.jsx)(l.A,{sx:{mt:3,p:2,bgcolor:"grey.100",borderRadius:2},children:(0,r.jsxs)(c.A,{variant:"h6",sx:{fontWeight:"bold",color:"primary.main"},children:["Total: R$ ",(ev.total||ey.filter(e=>e.order_id===ev.id).reduce((e,i)=>{var s;return e+i.quantity*((null==(s=i.menu_items)?void 0:s.price)||0)},0)).toFixed(2)]})})]}),(0,r.jsxs)(z.A,{children:[(0,r.jsx)(S.A,{onClick:eY,children:"Voltar"}),(0,r.jsx)(S.A,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(X.A,{}),onClick:()=>eZ(ev),children:"Pagamento"})]})]})}),(0,r.jsx)(R.A,{open:ek,onClose:eK,maxWidth:"sm",fullWidth:!0,children:ev&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.A,{children:(0,r.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,r.jsx)(c.A,{variant:"h6",children:"Finalizar Pedido"}),(0,r.jsx)(g.A,{onClick:eK,size:"small",children:(0,r.jsx)(Y.A,{})})]})}),(0,r.jsxs)(k.A,{children:[(0,r.jsxs)(l.A,{sx:{mb:3,p:2,bgcolor:"success.light",color:"white",borderRadius:2},children:[(0,r.jsxs)(c.A,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:["Mesa ",(null==(i=t.find(e=>e.id===ev.table_id))?void 0:i.number)||ev.table_id]}),(0,r.jsxs)(c.A,{variant:"h5",sx:{fontWeight:"bold"},children:["Total: R$ ",ev.allTableOrders?ev.allTableOrders.reduce((e,i)=>e+Number(i.total||ey.filter(e=>e.order_id===i.id).reduce((e,i)=>{var s;return e+i.quantity*((null==(s=i.menu_items)?void 0:s.price)||0)},0)),0):ev.total||ey.filter(e=>e.order_id===ev.id).reduce((e,i)=>{var s;return e+i.quantity*((null==(s=i.menu_items)?void 0:s.price)||0)},0),".toFixed(2)"]})]}),(0,r.jsx)(c.A,{variant:"body1",sx:{mb:3},children:"Confirme o recebimento do pagamento para finalizar este pedido, imprimir a comanda e liberar a mesa (se n\xe3o houver outros pedidos ativos para ela)."}),(0,r.jsxs)(l.A,{sx:{display:"flex",justifyContent:"center",gap:2,mb:2},children:[(0,r.jsx)(ei.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,r.jsxs)(v.A,{sx:{p:2,width:100,textAlign:"center",boxShadow:2,borderRadius:2},children:[(0,r.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Forma de Pagamento"}),(0,r.jsx)(c.A,{variant:"body1",sx:{fontWeight:"bold",mt:1},children:"Dinheiro"})]})}),(0,r.jsx)(ei.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,r.jsxs)(v.A,{sx:{p:2,width:100,textAlign:"center",boxShadow:2,borderRadius:2},children:[(0,r.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Forma de Pagamento"}),(0,r.jsx)(c.A,{variant:"body1",sx:{fontWeight:"bold",mt:1},children:"Cart\xe3o"})]})}),(0,r.jsx)(ei.P.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:(0,r.jsxs)(v.A,{sx:{p:2,width:100,textAlign:"center",boxShadow:2,borderRadius:2},children:[(0,r.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Forma de Pagamento"}),(0,r.jsx)(c.A,{variant:"body1",sx:{fontWeight:"bold",mt:1},children:"Pix"})]})})]})]}),(0,r.jsxs)(z.A,{children:[(0,r.jsx)(S.A,{onClick:eK,children:"Cancelar"}),(0,r.jsx)(S.A,{variant:"contained",color:"success",startIcon:eN?(0,r.jsx)(C.A,{size:20,color:"inherit"}):(0,r.jsx)(Z.A,{}),onClick:e2,disabled:eN,children:eN?"Imprimindo...":"Imprimir e Finalizar"})]})]})}),(0,r.jsx)("div",{style:{display:"none"},children:(0,r.jsx)("div",{ref:eL,children:(0,r.jsxs)(W.A,{sx:{p:3,maxWidth:"80mm",margin:"0 auto"},children:[(0,r.jsxs)(l.A,{sx:{textAlign:"center",mb:2},children:[(0,r.jsx)(c.A,{variant:"h6",sx:{fontWeight:"bold"},children:"Restaurante QR Menu"}),(0,r.jsx)(c.A,{variant:"body2",children:"CNPJ: 00.000.000/0001-00"}),(0,r.jsx)(c.A,{variant:"body2",children:new Date().toLocaleDateString("pt-BR")})]}),(0,r.jsx)(x.A,{sx:{mb:2}}),ev&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.A,{sx:{mb:2},children:[(0,r.jsxs)(c.A,{variant:"subtitle1",sx:{fontWeight:"bold"},children:["COMANDA - MESA ",(null==(s=t.find(e=>e.id===ev.table_id))?void 0:s.number)||ev.table_id]}),(0,r.jsxs)(c.A,{variant:"body2",children:["Pedido #",ev.id]}),(0,r.jsx)(c.A,{variant:"body2",children:new Date(ev.created_at).toLocaleString("pt-BR")})]}),(0,r.jsx)(x.A,{sx:{mb:2}}),(0,r.jsx)(c.A,{variant:"subtitle2",sx:{fontWeight:"bold",mb:1},children:"ITENS"}),ev.allTableOrders?ev.allTableOrders.flatMap(e=>ey.filter(i=>i.order_id===e.id).map((i,s)=>{var n,t;return(0,r.jsxs)(l.A,{sx:{mb:1,display:"flex",justifyContent:"space-between"},children:[(0,r.jsxs)(l.A,{children:[(0,r.jsxs)(c.A,{variant:"body2",children:[i.quantity,"x ",(null==(n=i.menu_items)?void 0:n.name)||"Item #".concat(i.menu_item_id)]}),i.notes&&(0,r.jsx)(c.A,{variant:"caption",sx:{display:"block",ml:2},children:i.notes})]}),(0,r.jsxs)(c.A,{variant:"body2",children:["R$ ",(((null==(t=i.menu_items)?void 0:t.price)||0)*i.quantity).toFixed(2)]})]},"".concat(e.id,"-").concat(i.id))})):ey.filter(e=>e.order_id===ev.id).map((e,i)=>{var s,n;return(0,r.jsxs)(l.A,{sx:{mb:1,display:"flex",justifyContent:"space-between"},children:[(0,r.jsxs)(l.A,{children:[(0,r.jsxs)(c.A,{variant:"body2",children:[e.quantity,"x ",(null==(s=e.menu_items)?void 0:s.name)||"Item #".concat(e.menu_item_id)]}),e.notes&&(0,r.jsx)(c.A,{variant:"caption",sx:{display:"block",ml:2},children:e.notes})]}),(0,r.jsxs)(c.A,{variant:"body2",children:["R$ ",(((null==(n=e.menu_items)?void 0:n.price)||0)*e.quantity).toFixed(2)]})]},e.id)}),(0,r.jsx)(x.A,{sx:{my:2}}),(0,r.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,r.jsx)(c.A,{variant:"subtitle2",sx:{fontWeight:"bold"},children:"TOTAL"}),(0,r.jsxs)(c.A,{variant:"subtitle2",sx:{fontWeight:"bold"},children:["R$ ",ev.allTableOrders?ev.allTableOrders.reduce((e,i)=>e+Number(i.total||ey.filter(e=>e.order_id===i.id).reduce((e,i)=>{var s;return e+i.quantity*((null==(s=i.menu_items)?void 0:s.price)||0)},0)),0):ev.total||ey.filter(e=>e.order_id===ev.id).reduce((e,i)=>{var s;return e+i.quantity*((null==(s=i.menu_items)?void 0:s.price)||0)},0),".toFixed(2)"]})]}),(0,r.jsx)(x.A,{sx:{my:2}}),(0,r.jsxs)(l.A,{sx:{textAlign:"center",mt:3},children:[(0,r.jsx)(c.A,{variant:"body2",children:"Obrigado pela prefer\xeancia!"}),(0,r.jsx)(c.A,{variant:"caption",sx:{display:"block",mt:1},children:"www.restauranteqrmenu.com.br"})]})]})]})})}),(0,r.jsx)(E.A,{open:eW.open,autoHideDuration:2500,onClose:()=>eE(e=>({...e,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,r.jsx)(M.A,{severity:eW.severity,variant:"filled",sx:{fontWeight:500},children:eW.message})})]})]})}}},e=>{var i=i=>e(e.s=i);e.O(0,[942,921,643,636,593,792],()=>i(4768)),_N_E=e.O()}]);